{"componentChunkName":"component---src-templates-blog-post-js","path":"/CKAD-preparation/2021-04-09-CKAD-Deployments/","result":{"data":{"site":{"siteMetadata":{"title":"Koushik's scribble"}},"markdownRemark":{"id":"ba143ab5-2729-51d3-ad8d-f8717bf66edf","excerpt":"The Deployment Controller within K8S is responsible for reinstating the state of the application based on the definition. A Deployment definition can be created…","html":"<!-- Post Content -->\n<p>The Deployment Controller within K8S is responsible for reinstating the state of the application based on the definition. A Deployment definition can be created to deploy ReplicaSet there by PODs or Delete the same. Deployment process typically have requirements to create new version of application, upgrade to next version of application, scale it as per load, rollback in case of failure. All these actions to be performed with minimal downtime. Deployment in K8S fulfil these requirements by default. Read through the <a href=\"https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#use-case\">use cases</a> </p>\n<h3>Definition File</h3>\n<p>The only difference between Deployment and ReplicaSet definitions files is the <code class=\"language-text\">kind</code></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># deployment-definition.yaml \n\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n    name: myapp-deployment\n    labels:\n        app: myapp\nspec:\n    replicas: 5\n    selector: \n        matchLabels:\n            type: frontend\n    template:\n        # Pod definition\n        metadata:\n            name: sample-app\n            labels:\n                app: myapp\n                type: frontend\n        spec:\n            containers:\n                - name: nginx-container\n                  image: nginx:1.14.2</code></pre></div>\n<h3>Commands</h3>\n<p>K8S Deployments is capable of performing <strong>rolling update</strong> only when the POD’s image is updated. So for example, <code class=\"language-text\">kubectl set image deployment.v1.apps/&lt;deployment-name></code>. Make sure the labels are untouched. Status check can be performed with <code class=\"language-text\">kubectl rollout status deployment/&lt;deployment-name></code></p>\n<p>So, now if the version needs a <strong>rollback</strong> - <code class=\"language-text\">kubectl rollout undo deployment.v1.apps/&lt;deployment-name></code>. If to a specific version <code class=\"language-text\">kubectl rollout undo deployment.v1.apps/&lt;deployment-name>  --to-revision=&lt;image-version-number></code></p>\n<p>Now, to scale number of PODs for a deployment, <code class=\"language-text\">kubectl scale deployment.v1.apps/&lt;deployment-name> --replicas=10</code></p>\n<blockquote>\n<p><strong>Note</strong>: Do not manage ReplicateSet created from a Deployment. </p>\n</blockquote>","frontmatter":{"title":"CKAD Preparation - Deployment","date":"April 09, 2021","description":"","tags":["kubernetes","ckad"]}}},"pageContext":{"slug":"/CKAD-preparation/2021-04-09-CKAD-Deployments/","previous":{"fields":{"slug":"/CKAD-preparation/2021-04-07-CKAD-Replicationsets/"},"frontmatter":{"title":"CKAD Preparation - ReplicationSets"}},"next":{"fields":{"slug":"/CKAD-preparation/2021-04-20-CKAD-Variables/"},"frontmatter":{"title":"CKAD Preparation - Variables"}}}},"staticQueryHashes":["2841359383"]}